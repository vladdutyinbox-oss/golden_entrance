++ - добавь примеров
~~ - задание на ответ

Основная задача компьютерного зрения - анализ изображения через
изучение и интерпретацию его сегментов - частей изображения,
разделяемых по классам. Каждому пикселю как неделимой части
присваивается класс

Способы сегментации:

1. Бинарная. Изображение логически делится на 2 части - фон и
целевой объект. Им соответствуют 2 класса.
Пример - выделение текста с картинки в простейших задачах
фото в текст когда на однородном поле нанесен однородный текст.
Другой пример - выявление трещин и брака на поверхностях в
промышленности
++

2. Многоклассовая сегментация. Определение нескольких
взаимно исключающих классов. Подразумевает возможность формировать
иерархию классов.
Включает в себя следующие подвиды:
- семантическая
- инстанс-сегментация
- паноптическая

Пример - анализ текстового документа и выделение заголовка,
 тела, заключения и соответствующих текстов


2.1 Семантическая сегментация. Это многоклассовая сегментация
для случая, когда нам нужно выявить наличие, качество и характер, но
не количество. Объекты одного класса считаются одинаковыми.
Позволяет выстроить иерархию классов и признаков.
Пример - на фото атвопарковки можно выделить иерархию с уровнями
1 - "автомобиль", 2 - "honda"/"mercedes"/"audi",
3 - "грузовой"/"легковой", однако объекты одного класса примет
одинаковыми и не посчитает их количество
Другой пример - система автопилота, которая нацелена на
определение множества классов - дорога, пешеход, машина.
И некоторые из них могут иерархическими, к примеру дорога (знаки, встречка)
Интерсно наличие препятствий, но не их количество


2.2 Инстанс-сегментация. Это сегментация
с возможностью посчитать количесто объектов одного класса
Пример - распознавание количества людей через видеокамеру. Полезно
менеджменту магазинов в анализе их загруженности.

2.3 Паноптическая. Явно выделяет 2 объекта иерархии - фон и целевые объекты.

Пример - продвинутый анализ движения на улице. Дорога, здания, светофоры
как фон, но все равно разделимы на иерархию для событийного анализа
сцен.


С задачей сегментации лучше остальных справляются нейронки со сверточной
обработкой изображений. Прямой проход в них делится на 2 этапа и
2 структурных блока - кодировщика и декодировшика:

1. Кодировщик
        Выявление иерархии признаков. Это несколько этапов, каждый из
    которых отвечает за свой уровень иерархии и представлен
    простейшими операциями:

         - Свертка. Представление иерархии признаков в векторах
         на карте признаков. Веса фильтров свертки обучаемы
         - Активация. Как правило Relu, поскольку алгоритмически прост
          (только замена отрицательных на 0) энерго-эффективен.
         - Пулинг. Замена квадратного региона карты признаков одним
         значением - наибольшим из региона. Адаптирует модель к
         сдвигам и упрощает сложность алгоритма прямого прохода
         - за счет уменьшения объема данных.

        Выход кодировщика - Тензор карт признаков по пикселям, отражающая
        контекст картинки - как признаки, так и связи между ними.
        Тензор имеет размер [batch, h_out, w_out, f_out], где
        batch - размер входного пакета изображений,
        h_out, w_out - соответственно высота и ширина выходной карты
        признаков в пикселях. Этот размер определяется как правило
        последним блоком кодировщика и часто малого размера.
        Например [1*1]
        f_out - количество признаков на выходе из последнего блока
        кодировщика.

        Как правило выход кодировщика представлен массивом векторов.
        Элемент массива это позиция в пакете изображений, а вектор
        содержит его контекст - признаки в количестве размерности
        вектора и связи между ними как неявные закономерности,
        наложенные последовательностью блоков
        [свертка-активация-пулинг]


2. Декодировщик.

        Классификация. Карту признаков отправляеют на softmax и оттуда
    берут argmax как предсказание класса. Перед softmax могут быть
    вспомогательные этапы, например uspampling+skip connections для
    большей детализации и точности предсказания.

    В зависимости от вида классификации - бинарной или многоклассововй,
    выход будет массивом веторов длиной от 1 до количества признаков, а каждый его
    элемент векора покажет вероятность принаддежность признака к классу -
    0 для ложных, один для истинного (one-hot вектор).

Выход декодировщика может быть направлен в трансформер для интерпретации
вывода

~~ уточни обе структуры - кодировщика и декодировщика и добавь примеры
бинарной и многоклассовой классификации








