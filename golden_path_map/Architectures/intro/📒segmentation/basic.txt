++ - –¥–æ–±–∞–≤—å –ø—Ä–∏–º–µ—Ä–æ–≤
~~ - –∑–∞–¥–∞–Ω–∏–µ –Ω–∞ –æ—Ç–≤–µ—Ç

(—Ü–∏—Ñ—Ä–∞) - –ø—Ä–∏–º–µ—á–∞–Ω–∏–µ

–û—Å–Ω–æ–≤–Ω–∞—è –∑–∞–¥–∞—á–∞ –∫–æ–º–ø—å—é—Ç–µ—Ä–Ω–æ–≥–æ –∑—Ä–µ–Ω–∏—è - –∞–Ω–∞–ª–∏–∑ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —á–µ—Ä–µ–∑
–∏–∑—É—á–µ–Ω–∏–µ –∏ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—é –µ–≥–æ —Å–µ–≥–º–µ–Ω—Ç–æ–≤ - —á–∞—Å—Ç–µ–π –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è,
—Ä–∞–∑–¥–µ–ª—è–µ–º—ã—Ö –ø–æ –∫–ª–∞—Å—Å–∞–º. –ö–∞–∂–¥–æ–º—É –ø–∏–∫—Å–µ–ª—é –∫–∞–∫ –Ω–µ–¥–µ–ª–∏–º–æ–π —á–∞—Å—Ç–∏
–ø—Ä–∏—Å–≤–∞–∏–≤–∞–µ—Ç—Å—è –∫–ª–∞—Å—Å

–°–ø–æ—Å–æ–±—ã —Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏–∏:

1. –ë–∏–Ω–∞—Ä–Ω–∞—è. –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ª–æ–≥–∏—á–µ—Å–∫–∏ –¥–µ–ª–∏—Ç—Å—è –Ω–∞ 2 —á–∞—Å—Ç–∏ - —Ñ–æ–Ω –∏
—Ü–µ–ª–µ–≤–æ–π –æ–±—ä–µ–∫—Ç. –ò–º —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç 2 –∫–ª–∞—Å—Å–∞.
–ü—Ä–∏–º–µ—Ä - –≤—ã–¥–µ–ª–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞ —Å –∫–∞—Ä—Ç–∏–Ω–∫–∏ –≤ –ø—Ä–æ—Å—Ç–µ–π—à–∏—Ö –∑–∞–¥–∞—á–∞—Ö
—Ñ–æ—Ç–æ –≤ —Ç–µ–∫—Å—Ç –∫–æ–≥–¥–∞ –Ω–∞ –æ–¥–Ω–æ—Ä–æ–¥–Ω–æ–º –ø–æ–ª–µ –Ω–∞–Ω–µ—Å–µ–Ω –æ–¥–Ω–æ—Ä–æ–¥–Ω—ã–π —Ç–µ–∫—Å—Ç.
–î—Ä—É–≥–æ–π –ø—Ä–∏–º–µ—Ä - –≤—ã—è–≤–ª–µ–Ω–∏–µ —Ç—Ä–µ—â–∏–Ω –∏ –±—Ä–∞–∫–∞ –Ω–∞ –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç—è—Ö –≤
–ø—Ä–æ–º—ã—à–ª–µ–Ω–Ω–æ—Å—Ç–∏
++

2. –ú–Ω–æ–≥–æ–∫–ª–∞—Å—Å–æ–≤–∞—è —Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏—è. –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö
–≤–∑–∞–∏–º–Ω–æ –∏—Å–∫–ª—é—á–∞—é—â–∏—Ö –∫–ª–∞—Å—Å–æ–≤. –ü–æ–¥—Ä–∞–∑—É–º–µ–≤–∞–µ—Ç –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å
–∏–µ—Ä–∞—Ä—Ö–∏—é –∫–ª–∞—Å—Å–æ–≤.
–í–∫–ª—é—á–∞–µ—Ç –≤ —Å–µ–±—è —Å–ª–µ–¥—É—é—â–∏–µ –ø–æ–¥–≤–∏–¥—ã:
- —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∞—è
- –∏–Ω—Å—Ç–∞–Ω—Å-—Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏—è
- –ø–∞–Ω–æ–ø—Ç–∏—á–µ—Å–∫–∞—è

–ü—Ä–∏–º–µ—Ä - –∞–Ω–∞–ª–∏–∑ —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞ –∏ –≤—ã–¥–µ–ª–µ–Ω–∏–µ –∑–∞–≥–æ–ª–æ–≤–∫–∞,
 —Ç–µ–ª–∞, –∑–∞–∫–ª—é—á–µ–Ω–∏—è –∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏—Ö —Ç–µ–∫—Å—Ç–æ–≤


2.1 –°–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∞—è —Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏—è. –≠—Ç–æ –º–Ω–æ–≥–æ–∫–ª–∞—Å—Å–æ–≤–∞—è —Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏—è
–¥–ª—è —Å–ª—É—á–∞—è, –∫–æ–≥–¥–∞ –Ω–∞–º –Ω—É–∂–Ω–æ –≤—ã—è–≤–∏—Ç—å –Ω–∞–ª–∏—á–∏–µ, –∫–∞—á–µ—Å—Ç–≤–æ –∏ —Ö–∞—Ä–∞–∫—Ç–µ—Ä, –Ω–æ
–Ω–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ. –û–±—ä–µ–∫—Ç—ã –æ–¥–Ω–æ–≥–æ –∫–ª–∞—Å—Å–∞ —Å—á–∏—Ç–∞—é—Ç—Å—è –æ–¥–∏–Ω–∞–∫–æ–≤—ã–º–∏.
–ü–æ–∑–≤–æ–ª—è–µ—Ç –≤—ã—Å—Ç—Ä–æ–∏—Ç—å –∏–µ—Ä–∞—Ä—Ö–∏—é –∫–ª–∞—Å—Å–æ–≤ –∏ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤.
–ü—Ä–∏–º–µ—Ä - –Ω–∞ —Ñ–æ—Ç–æ –∞—Ç–≤–æ–ø–∞—Ä–∫–æ–≤–∫–∏ –º–æ–∂–Ω–æ –≤—ã–¥–µ–ª–∏—Ç—å –∏–µ—Ä–∞—Ä—Ö–∏—é —Å —É—Ä–æ–≤–Ω—è–º–∏
1 - "–∞–≤—Ç–æ–º–æ–±–∏–ª—å", 2 - "honda"/"mercedes"/"audi",
3 - "–≥—Ä—É–∑–æ–≤–æ–π"/"–ª–µ–≥–∫–æ–≤–æ–π", –æ–¥–Ω–∞–∫–æ –æ–±—ä–µ–∫—Ç—ã –æ–¥–Ω–æ–≥–æ –∫–ª–∞—Å—Å–∞ –ø—Ä–∏–º–µ—Ç
–æ–¥–∏–Ω–∞–∫–æ–≤—ã–º–∏ –∏ –Ω–µ –ø–æ—Å—á–∏—Ç–∞–µ—Ç –∏—Ö –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ
–î—Ä—É–≥–æ–π –ø—Ä–∏–º–µ—Ä - —Å–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–ø–∏–ª–æ—Ç–∞, –∫–æ—Ç–æ—Ä–∞—è –Ω–∞—Ü–µ–ª–µ–Ω–∞ –Ω–∞
–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –º–Ω–æ–∂–µ—Å—Ç–≤–∞ –∫–ª–∞—Å—Å–æ–≤ - –¥–æ—Ä–æ–≥–∞, –ø–µ—à–µ—Ö–æ–¥, –º–∞—à–∏–Ω–∞.
–ò –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –∏–∑ –Ω–∏—Ö –º–æ–≥—É—Ç –∏–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫–∏–º–∏, –∫ –ø—Ä–∏–º–µ—Ä—É –¥–æ—Ä–æ–≥–∞ (–∑–Ω–∞–∫–∏, –≤—Å—Ç—Ä–µ—á–∫–∞)
–ò–Ω—Ç–µ—Ä—Å–Ω–æ –Ω–∞–ª–∏—á–∏–µ –ø—Ä–µ–ø—è—Ç—Å—Ç–≤–∏–π, –Ω–æ –Ω–µ –∏—Ö –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ


2.2 –ò–Ω—Å—Ç–∞–Ω—Å-—Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏—è. –≠—Ç–æ —Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏—è
—Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é –ø–æ—Å—á–∏—Ç–∞—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–æ –æ–±—ä–µ–∫—Ç–æ–≤ –æ–¥–Ω–æ–≥–æ –∫–ª–∞—Å—Å–∞
–ü—Ä–∏–º–µ—Ä - —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –ª—é–¥–µ–π —á–µ—Ä–µ–∑ –≤–∏–¥–µ–æ–∫–∞–º–µ—Ä—É. –ü–æ–ª–µ–∑–Ω–æ
–º–µ–Ω–µ–¥–∂–º–µ–Ω—Ç—É –º–∞–≥–∞–∑–∏–Ω–æ–≤ –≤ –∞–Ω–∞–ª–∏–∑–µ –∏—Ö –∑–∞–≥—Ä—É–∂–µ–Ω–Ω–æ—Å—Ç–∏.

2.3 –ü–∞–Ω–æ–ø—Ç–∏—á–µ—Å–∫–∞—è. –Ø–≤–Ω–æ –≤—ã–¥–µ–ª—è–µ—Ç 2 –æ–±—ä–µ–∫—Ç–∞ –∏–µ—Ä–∞—Ä—Ö–∏–∏ - —Ñ–æ–Ω –∏ —Ü–µ–ª–µ–≤—ã–µ –æ–±—ä–µ–∫—Ç—ã.

–ü—Ä–∏–º–µ—Ä - –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π –∞–Ω–∞–ª–∏–∑ –¥–≤–∏–∂–µ–Ω–∏—è –Ω–∞ —É–ª–∏—Ü–µ. –î–æ—Ä–æ–≥–∞, –∑–¥–∞–Ω–∏—è, —Å–≤–µ—Ç–æ—Ñ–æ—Ä—ã
–∫–∞–∫ —Ñ–æ–Ω, –Ω–æ –≤—Å–µ —Ä–∞–≤–Ω–æ —Ä–∞–∑–¥–µ–ª–∏–º—ã –Ω–∞ –∏–µ—Ä–∞—Ä—Ö–∏—é –¥–ª—è —Å–æ–±—ã—Ç–∏–π–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞
—Å—Ü–µ–Ω.


–° –∑–∞–¥–∞—á–µ–π —Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏–∏ –ª—É—á—à–µ –æ—Å—Ç–∞–ª—å–Ω—ã—Ö —Å–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –Ω–µ–π—Ä–æ–Ω–∫–∏ —Å–æ —Å–≤–µ—Ä—Ç–æ—á–Ω–æ–π
–æ–±—Ä–∞–±–æ—Ç–∫–æ–π –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π. –ü—Ä—è–º–æ–π –ø—Ä–æ—Ö–æ–¥ –≤ –Ω–∏—Ö –¥–µ–ª–∏—Ç—Å—è –Ω–∞ 2 —ç—Ç–∞–ø–∞ –∏
2 —Å—Ç—Ä—É–∫—Ç—É—Ä–Ω—ã—Ö –±–ª–æ–∫–∞ - –∫–æ–¥–∏—Ä–æ–≤—â–∏–∫–∞ –∏ –¥–µ–∫–æ–¥–∏—Ä–æ–≤—à–∏–∫–∞:

1. –ö–æ–¥–∏—Ä–æ–≤—â–∏–∫
        –í—ã—è–≤–ª–µ–Ω–∏–µ –∏–µ—Ä–∞—Ä—Ö–∏–∏ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤. –≠—Ç–æ –Ω–µ—Å–∫–æ–ª—å–∫–æ —ç—Ç–∞–ø–æ–≤, –∫–∞–∂–¥—ã–π –∏–∑
    –∫–æ—Ç–æ—Ä—ã—Ö –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ —Å–≤–æ–π —É—Ä–æ–≤–µ–Ω—å –∏–µ—Ä–∞—Ä—Ö–∏–∏ –∏ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω
    –ø—Ä–æ—Å—Ç–µ–π—à–∏–º–∏ –æ–ø–µ—Ä–∞—Ü–∏—è–º–∏:

         - –°–≤–µ—Ä—Ç–∫–∞. –ü—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –∏–µ—Ä–∞—Ä—Ö–∏–∏ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –≤ –≤–µ–∫—Ç–æ—Ä–∞—Ö
         –Ω–∞ –∫–∞—Ä—Ç–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤. –í–µ—Å–∞ —Ñ–∏–ª—å—Ç—Ä–æ–≤ —Å–≤–µ—Ä—Ç–∫–∏ –æ–±—É—á–∞–µ–º—ã
         - –ê–∫—Ç–∏–≤–∞—Ü–∏—è. –ö–∞–∫ –ø—Ä–∞–≤–∏–ª–æ Relu, –ø–æ—Å–∫–æ–ª—å–∫—É –∞–ª–≥–æ—Ä–∏—Ç–º–∏—á–µ—Å–∫–∏ –ø—Ä–æ—Å—Ç
          (—Ç–æ–ª—å–∫–æ –∑–∞–º–µ–Ω–∞ –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã—Ö –Ω–∞ 0) —ç–Ω–µ—Ä–≥–æ-—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–µ–Ω.
         - –ü—É–ª–∏–Ω–≥. –ó–∞–º–µ–Ω–∞ –∫–≤–∞–¥—Ä–∞—Ç–Ω–æ–≥–æ —Ä–µ–≥–∏–æ–Ω–∞ –∫–∞—Ä—Ç—ã –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –æ–¥–Ω–∏–º
         –∑–Ω–∞—á–µ–Ω–∏–µ–º - –Ω–∞–∏–±–æ–ª—å—à–∏–º –∏–∑ —Ä–µ–≥–∏–æ–Ω–∞. –ê–¥–∞–ø—Ç–∏—Ä—É–µ—Ç –º–æ–¥–µ–ª—å –∫
         —Å–¥–≤–∏–≥–∞–º –∏ —É–ø—Ä–æ—â–∞–µ—Ç –≤—ã—á–∏—á–ª–∏—Ç–µ–ª—å–Ω—É—é —Å–ª–æ–∂–Ω–æ—Å—Ç—å –∞–ª–≥–æ—Ä–∏—Ç–º–∞
         –ø—Ä—è–º–æ–≥–æ –ø—Ä–æ—Ö–æ–¥–∞ –∑–∞ —Å—á–µ—Ç —É–º–µ–Ω—å—à–µ–Ω–∏—è –æ–±—ä–µ–º–∞ –¥–∞–Ω–Ω—ã—Ö.

        –í—ã—Ö–æ–¥ –∫–æ–¥–∏—Ä–æ–≤—â–∏–∫–∞ - –¢–µ–Ω–∑–æ—Ä –∫–∞—Ä—Ç –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –ø–æ –ø–∏–∫—Å–µ–ª—è–º, –æ—Ç—Ä–∞–∂–∞—é—â–∞—è
        –∫–æ–Ω—Ç–µ–∫—Å—Ç –∫–∞—Ä—Ç–∏–Ω–∫–∏ - –∫–∞–∫ –ø—Ä–∏–∑–Ω–∞–∫–∏, —Ç–∞–∫ –∏ —Å–≤—è–∑–∏ –º–µ–∂–¥—É –Ω–∏–º–∏.
        –¢–µ–Ω–∑–æ—Ä –∏–º–µ–µ—Ç —Ä–∞–∑–º–µ—Ä [batch, h_out, w_out, f_out] (1), –≥–¥–µ
        batch - —Ä–∞–∑–º–µ—Ä –≤—Ö–æ–¥–Ω–æ–≥–æ –ø–∞–∫–µ—Ç–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π,
        h_out, w_out - —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ –≤—ã—Å–æ—Ç–∞ –∏ —à–∏—Ä–∏–Ω–∞ –≤—ã—Ö–æ–¥–Ω–æ–π –∫–∞—Ä—Ç—ã
        –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –≤ –ø–∏–∫—Å–µ–ª—è—Ö. –≠—Ç–æ—Ç —Ä–∞–∑–º–µ—Ä –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –∫–∞–∫ –ø—Ä–∞–≤–∏–ª–æ
        –ø–æ—Å–ª–µ–¥–Ω–∏–º –±–ª–æ–∫–æ–º –∫–æ–¥–∏—Ä–æ–≤—â–∏–∫–∞ –∏ —á–∞—Å—Ç–æ –º–∞–ª–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞.
        –ù–∞–ø—Ä–∏–º–µ—Ä [1*1]
        f_out - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –Ω–∞ –≤—ã—Ö–æ–¥–µ –∏–∑ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –±–ª–æ–∫–∞
        –∫–æ–¥–∏—Ä–æ–≤—â–∏–∫–∞.

        –ö–∞—Ä—Ç–∞ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ —ç—Ç–æ —Ç–µ–Ω–∑–æ—Ä [h_out, w_out, f_out], –∏ –æ–Ω–∞
        –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –º–∞—Ç—Ä–∏—Ü—É –ø–∏–∫—Å–µ–ª–µ–π, –≥–¥–µ –∫–∞–∂–¥–æ–º—É –ø–∏–∫—Å–µ–ª—é
        —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –≤–µ–∫—Ç–æ—Ä –ø—Ä–∏–∑–Ω–∞–∫–æ–≤.


2. –î–µ–∫–æ–¥–∏—Ä–æ–≤—â–∏–∫.

        –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è. –ü–æ –∫–∞—Ä—Ç–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –¥–∞–µ—Ç –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ –∫–ª–∞—Å—Å–∞
    –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–∏–∫—Å–µ–ª—è –∏–∑ –∫–∞—Ä—Ç—ã. –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –∫–∞—Ä—Ç—É –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –Ω–∞ –∫–∞—Ä—Ç—É
    –∫–ª–∞—Å—Å–æ–≤ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–∏–∫—Å–µ–ª—è, –ø—Ä–∏–≤–æ–¥—è –µ—ë —Ä–∞–∑–º–µ—Ä –∫ –∏—Å—Ö–æ–¥–Ω–æ–º—É. –ü–∞–∫–µ—Ç
    –ö–∞—Ä—Ç –∫–ª–∞—Å—Å–æ–≤ —ç—Ç–æ –≤—ã—Ö–æ–¥, –∏ –æ–Ω —è–≤–ª—è–µ—Ç—Å—è —Ç–µ–Ω–∑–æ—Ä–æ–º
    [batch, h_in, w_in, N_classes] (1), –≥–¥–µ

    batch - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –≤–æ –≤—Ö–æ–¥–Ω–æ–π –≤—ã–±–æ—Ä–∫–µ,
    h_in, w_in - –≤—ã—Å–æ—Ç–∞ –∏ —à–∏—Ä–∏–Ω–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è, —Ä–∞–≤–Ω—ã–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–º
    —Ä–∞–∑–º–µ—Ä–∞–º –≤—Ö–æ–¥–Ω–æ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏–∑ –≤—ã–±–æ—Ä–∫–∏,
    N_classes - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–ª–∞—Å—Å–æ–≤, –Ω–∞ —Ä–∞–∑–ª–∏—á–µ–Ω–∏–µ –∫–æ—Ç–æ—Ä—ã—Ö –æ–±—É—á–µ–Ω–∞ –º–æ–¥–µ–ª—å

    –ö–∞—Ä—Ç–∞ –∫–ª–∞—Å—Å–æ–≤ —ç—Ç–æ –º–∞—Ç—Ä–∏—Ü–∞ –ø–∏–∫—Å–µ–ª–µ–π [h_in, w_in, N_classes], –≥–¥–µ
    –∫–∞–∂–¥—ã–π —ç–ª–µ–º–µ–Ω—Ç –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω one-hot –≤–µ–∫—Ç–æ—Ä–æ–º. –ü–æ–∑–∏—Ü–∏–∏ –≤–µ–∫—Ç–æ—Ä–æ–≤
    –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç –∏—Å—Ç–∏–Ω–Ω—ã–π –∫–ª–∞—Å—Å –∫–∞–∫ 1, –æ—Å—Ç–∞–ª—å–Ω—ã–µ –æ–±—Ä–∞—â–∞–µ—Ç –≤ 0.

    –ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π –ø—Ä–æ—Ö–æ–¥ —á–µ—Ä–µ–∑ –¥–µ–∫–æ–¥–∏—Ä–æ–≤—â–∏–∫ —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ —Ç–∞–∫–∏—Ö –æ–ø–µ—Ä–∞—Ü–∏–π:
     upscaling - –ø—ã–≤—ã—à–µ–Ω–∏–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –∫–∞—Ä—Ç—ã –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ —á–µ—Ä–µ–∑ –±–∏–Ω–∞—Ä–Ω—É—é
     –∏–Ω—Ç–µ—Ä–ø–æ–ª—è—Ü–∏—é
     skip connections - –Ω–∞–ª–æ–∂–µ–Ω–∏–µ –∫–∞—Ä—Ç –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ —Ä–∞–∑–Ω–æ–π —Ç–æ—á–Ω–æ—Å—Ç–∏
     –¥–ª—è –ª—É—á—à–µ–≥–æ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –∏ –¥–µ—Ç–∞–ª–∏–∑–∞—Ü–∏–∏
     conv/ffn layer - —Å–≤–µ—Ä—Ç–∫–∞ —Å —è–¥—Ä–∞–º–∏ 1*1 –∏–ª–∏ –ø–æ–ª–Ω–æ—Å–≤—è–∑–Ω—ã–π —Å–ª–æ–π –¥–ª—è
     –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π —Å–≤—è–∑–∫–∏ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –ø–æ—Å–ª–µ upscaling/skip conn, –∞ —Ç–∞–∫–∂–µ
     –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è —Ç–∞–∫–∏—Ö —Å–≤—è–∑–µ–π –Ω–∞ –Ω—É–∂–Ω–æ–µ —á–∏—Å–ª–æ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
     (–∫–∞–∫ –ø—Ä–∞–≤–∏–ª–æ –º–µ–Ω—å—à–µ–µ) –ø–µ—Ä–µ–¥ —Å–ª–µ–¥—É—é—â–∏–º upscale/–ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ–º
     –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è - softmax + argmax –ø–æ –≤–µ–∫—Ç–æ—Ä—É –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –∫–∞–∂–¥–æ–≥–æ –ø–∏–∫—Å–µ–ª—è
     –∏ —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–∞—Ä—Ç—ã –∫–ª–∞—Å—Å–æ–≤.



–ü—Ä–∏–º–µ—á–∞–Ω–∏—è:

(1)

    –î–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –Ω–∞ GPU –∏ CPU –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è 2 —Ä–∞–∑–Ω—ã–µ —Ñ–æ—Ä–º—ã —Ç–µ–Ω–∑–æ—Ä–æ–≤,
—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ channels-first –∏ channels-last. –í –ø–µ—Ä–≤–æ–º —Å–ª—É—á–∞–µ –º—ã
–æ–ø—Ä–µ–¥–µ–ª—è–µ–º —Ä–∞–∑–º–µ—Ä—ã —Ç–µ–Ω–∑–æ—Ä–∞ –∫–∞–∫ [B, C, H, W], –≤ –≤—Ç–æ—Ä–æ–º - [B, H, W, C],
–≥–¥–µ
B - —Ä–∞–∑–º–µ—Ä –≤—Ö–æ–¥—è—â–µ–≥–æ –ø–∞–∫–µ—Ç–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π (batch)
C - —á–∏—Å–ª–æ –∫–∞–Ω–∞–ª–æ–≤ (–ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –ø–∏–∫—Å–µ–ª–µ–π), channels
H, W - –≤—ã—Å–æ—Ç–∞ –∏ —à–∏—Ä–∏–Ω–∞ –∫–∞–∂–¥–æ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤ –ø–∏–∫—Å–µ–ª—è—Ö

–í—ã–±–æ—Ä —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç 2-—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ - –æ–±—ä–µ–º –≤—Ö–æ–¥—è—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö (V)
–∏ (P) - –∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω–æ—Å—Ç—å –≤—ã—á–∏—Å–ª–µ–Ω–∏–π(–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ü–∏–∫–ª–æ–≤ –∏ –∏—Ç–µ—Ä–∞—Ü–∏–π –≤ –Ω–∏—Ö).
–ú–æ–∂–Ω–æ –≤—ã–≤–µ—Å—Ç–∏ —Ñ–æ—Ä–º—É–ª—É device = V*P. –§—É–Ω–∫—Ü–∏—è –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –¥–≤–µ –æ–±–ª–∞—Å—Ç–∏,
–∏ –ø–µ—Ä–µ—Ö–æ–¥ –º–µ–∂–¥—É –Ω–∏–º–∏ –º–æ–∂–Ω–æ –≤—ã—Ä–∞–∑–∏—Ç—å —Å–∏–≥–º–æ–∏–¥–æ–π.
V –∏ P –∑–∞–≤–∏—Å—è—Ç –æ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤. –í–æ—Ç –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –∏–∑ –Ω–∏—Ö:

V - –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã –ø–∞–º—è—Ç–∏ –∏ –≤ —á–∞—Å—Ç–Ω–æ—Å—Ç–∏ –æ–±—ä–µ–º–æ–≤ l1/l2 –∫—ç—à–µ–π.
–û—Ç –Ω–∏—Ö –∑–∞–≤–∏—Å—è—Ç –ø–æ–∫–∞–∑–∞—Ç–µ–ª—å hit rate –∏ —á–∞—Å—Ç–æ—Ç–∞ –≤—ã—Ç–µ—Å–Ω–µ–Ω–∏–π eviction –ø—Ä–∏
–ø—Ä–æ–º–∞—Ö–µ –ø–æ –∫–µ—à—É.
P - –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —è–¥–µ—Ä –∏ —á–∞—Å—Ç–æ—Ç—ã –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞, –∞–ª–≥–æ—Ä–∏–∏—Ç–º–∏—á–µ—Å–∫–æ–π
—Å–ª–æ–∂–Ω–æ—Å—Ç–∏ –ø—Ä—è–º–æ–≥–æ –∏ –æ–±—Ä–∞—Ç–Ω–æ–≥–æ –ø—Ä–æ—Ö–æ–¥–æ–≤ –º–æ–¥–µ–ª–∏ –Ω–µ–π—Ä–æ–Ω–∫–∏.

–ë–æ–ª—å—à–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è –æ–ø—Ä–µ–¥–µ–ª—è—é—Ç –æ–±–ª–∞—Å—Ç—å GPU, –º–µ–Ω—å—à–∏–µ - CPU.
–¢–∞–∫–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ —Å–≤—è–∑–∞–Ω–æ —Å –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç—è–º–∏ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä –¥–≤—É—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤.
–ï—Å–ª–∏ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –ø—Ä–æ—Å—Ç—ã, –∞ –æ–±—ä–µ–º –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª–Ω–æ—Å—Ç—å—é –ø–æ–º–µ—â–∞–µ—Ç—Å—è –≤
l1/l2, –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å CPU device. –¢–∞–∫–∏–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –∫–∞–∫
–ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã–π –¥–æ—Å—Ç—É–ø CPU –∫ –¥–∞–Ω–Ω—ã–º, –∞ —Ç–∞–∫–∂–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ L1/l2 —Å –º–∞–ª—ã–º
–æ–±—ä–µ–º–æ–º –ø–æ–ª–Ω–æ—Å—Ç—å—é —É–∫–ª–∞–¥—ã–≤–∞—é—Ç—Å—è –≤ —Ä–∞–º–∫–∏ –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–π —Ä–∞–±–æ—Ç—ã –º–æ–¥–µ–ª–∏.
–í –∏–Ω–æ–º —Å–ª—É—á–∞–µ, –∫–æ–≥–¥–∞ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞ —Ñ–∏–ª—å—Ç—Ä–æ–≤ —Å–≤–µ—Ç–∫–∏ –Ω–∞ —Ä–∞–∑–Ω—ã—Ö —è–¥—Ä–∞—Ö
–∏ —É—Å–∫–æ—Ä–µ–Ω–∏–µ –∑–∞ —Å—á–µ—Ç –≤—ã—Å–æ–∫–æ–≥–æ hit rate l1/l2 –Ω–µ –¥–∞—é—Ç –Ω—É–∂–Ω–æ–≥–æ —ç—Ñ—Ñ–µ–∫—Ç–∞,
–Ω—É–∂–Ω–æ –¥–≤–∏–≥–∞—Ç—å—Å—è –Ω–∞ GPU.

–ö–æ–≥–¥–∞ –º—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º CPU, –æ–±—ä–µ–º –≤—Ö–æ–¥—è—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö –∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ
—Ä–µ—Å—É—Ä—Å—ã –ø—Ä–æ—Ü–µ—Å—Å–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–æ–ª–∂–Ω—ã –ø–æ–º–µ—â–∞—Ç—å—Å—è –ø–æ–ª–Ω–æ—Å—Ç—å—é –≤ –∫—ç—à–µ l1/l2.
–í —ç—Ç–æ–º —Å–ª—É—á–∞–µ –¥–∞–∂–µ –µ—Å–ª–∏ —Ñ–∏–ª—å—Ç—Ä–æ–≤ –≥–æ—Ä–∞–∑–¥–æ –±–æ–ª—å—à–µ —è–¥–µ—Ä –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞,
–º—ã –∫–æ–º–ø–µ–Ω—Å–∏—Ä—É–µ–º –∑–∞–¥–µ—Ä–∂–∫—É CPU-bound –∑–∞ —Å—á–µ—Ç –≤—ã—Å–æ–∫–æ–≥–æ hit rate –∏
–æ—Ç—Å—É—Ç—Å—Ç–≤–∏—è –∑–∞—Ç—Ä–∞—Ç –Ω–∞ –≤—ã—Ç–µ—Å–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∏–∑ –∫—ç—à–∞(eviction).
–í —Ç–∞–∫–∏—Ö —É—Å–ª–æ–≤–∏—è—Ö —É–¥–æ–±–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å channels-last, –ø–æ—Å–∫–æ–ª—å–∫—É –º—ã
—Ä–∞–∑–Ω—ã–µ —Ñ–∏–ª—å—Ç—Ä—ã –ø–æ–º–µ—â–∞–µ–º –Ω–∞ —Ä–∞–∑–Ω—ã–µ —è–¥—Ä–∞. –í —Ä–∞–º–∫–∞—Ö –æ–¥–Ω–æ–≥–æ —Ñ–∏–ª—å—Ç—Ä–∞ –º—ã
–º–æ–∂–µ–º –±—ã—Å—Ç—Ä–æ –ø—Ä–æ–π—Ç–∏ –ø–æ –≤—Å–µ–º –∫–∞–Ω–∞–ª–∞–º –∏ –≤—Å–µ–º –ø–∏–∫—Å–µ–ª—è–º –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö –æ–¥–Ω–æ–≥–æ
–∫–∞–Ω–∞–ª–∞ –±–ª–∞–≥–æ–¥–∞—Ä—è —Å–∫–æ—Ä–æ—Å—Ç–∏ –¥–æ—Å—Ç—É–ø–∞ –≤ –∫—ç—à.


üìíüìó
l1 –¥–ª—è —è–¥–µ—Ä, –∞ l2 –Ω–∞ CPU? —Å–ø–æ—Å–æ–±—ã –¥–æ—Å—Ç—É–ø–∞ –∫ –¥–∞–Ω–Ω—ã–º - –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã–π
–∏ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–π –Ω–∞ GPU/CPU.
–ü–æ—á–µ–º—É channels first –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ –Ω–∞ gpu






–ë–∞–∑–æ–≤—ã–µ –±–ª–æ–∫–∏:

1. –°–≤–µ—Ä—Ç–∫–∞. –ú–æ–∑–≥ —Å–≤–µ—Ä—Ç–æ—á–Ω—ã—Ö –Ω–µ–π—Ä–æ–Ω–æ–∫. –í—Å–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ –±–ª–æ–∫–∏ –æ–ø—Ç–∏–º–∏–∑–∏—Ä—É—é—Ç
—Ä–∞–±–æ—Ç—É —Å–≤–µ—Ä—Ç–æ–∫. –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç –û—Ç–≤–µ—á–∞–µ—Ç –∑–∞ –≤—ã—è–≤–ª–µ–Ω–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –æ–ø–∏—Å—ã–≤–∞—é—Ç
–æ–±–ª–∞—Å—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è.




–ü–æ—Å–ª–µ –±–∞–∑–æ–≤—ã—Ö –±–ª–æ–∫–æ–≤:

–° –ø—Ä–∏–º–µ—Ä–∞–º–∏:

–í—ã—Ö–æ–¥ –º–æ–¥–µ–ª–∏ ‚Äî –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ (–ø–æ—Å–ª–µ softmax), –Ω–µ one-hot (one-hot ‚Äî
—ç—Ç–æ —Ñ–æ—Ä–º–∞—Ç ground truth –¥–ª—è –æ–±—É—á–µ–Ω–∏—è; –º–æ–¥–µ–ª—å –≤—ã–¥–∞—ë—Ç soft
probabilities, argmax –¥–∞—ë—Ç –∫–ª–∞—Å—Å—ã).
–†–∞–∑–º–µ—Ä ‚Äî –æ–±—ã—á–Ω–æ [B, N_classes, H, W] (–∫–∞–Ω–∞–ª—ã=–∫–ª–∞—Å—Å—ã first –≤
PyTorch –¥–ª—è softmax).
–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ/—É—Ç–æ—á–Ω–µ–Ω–∏–µ: –í—ã—Ö–æ–¥ ‚Äî —Ç–µ–Ω–∑–æ—Ä –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π [B, N_classes,
H_in, W_in]; argmax –ø–æ –∫–∞–Ω–∞–ª–∞–º –¥–∞—ë—Ç –º–∞—Å–∫—É [B, 1, H_in, W_in] —Å
–∫–ª–∞—Å—Å–æ–≤—ã–º–∏ ID. One-hot ‚Äî –¥–ª—è labels –≤ loss (categorical
cross-entropy). –ü—Ä–∏–º–µ—Ä: –î–ª—è N_classes=3, –ø–∏–∫—Å–µ–ª—å —Å –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—è–º–∏
[0.1, 0.8, 0.1] ‚Üí argmax=1 (–∫–ª–∞—Å—Å 1).





